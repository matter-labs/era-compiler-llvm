; RUN: llvm-mc -arch=eravm --show-encoding < %s | FileCheck %s

  .text
foo:
  add stack-=[r1], r1, r2
  add stack-=[42], r1, r2
  add stack-=[r1+42], r1, r2
  add r0, r1, stack+=[r1]
  add r0, r1, stack+=[42]
  add r0, r1, stack+=[r1+42]
  add stack-=[r1+42], r1, stack+=[r1+1]

  nop r0, r0, stack+=[r1+42]
  nop stack-=[r1+42], r0, r0

  nop stack+=[r1+42]
  nop stack-=[r1+42]

  nop r0, r0, r0
  nop

; CHECK:  .text
; CHECK:foo:

; CHECK:  add   stack-=[0 + r1], r1, r2         ; encoding: [0x00,0x00,0x00,0x00,0x02,0x11,0x00,0x21]
; CHECK:  add   stack-=[42], r1, r2             ; encoding: [0x00,0x00,0x00,0x2a,0x02,0x10,0x00,0x21]
; CHECK:  add   stack-=[42 + r1], r1, r2        ; encoding: [0x00,0x00,0x00,0x2a,0x02,0x11,0x00,0x21]
; CHECK:  add   r0, r1, stack+=[0 + r1]         ; encoding: [0x00,0x00,0x00,0x00,0x01,0x10,0x00,0x1b]
; CHECK:  add   r0, r1, stack+=[42]             ; encoding: [0x00,0x2a,0x00,0x00,0x00,0x10,0x00,0x1b]
; CHECK:  add   r0, r1, stack+=[42 + r1]        ; encoding: [0x00,0x2a,0x00,0x00,0x01,0x10,0x00,0x1b]
; CHECK:  add   stack-=[42 + r1], r1, stack+=[1 + r1] ; encoding: [0x00,0x01,0x00,0x2a,0x01,0x11,0x00,0x23]

; CHECK:  nop   stack+=[42 + r1]                ; encoding: [0x00,0x2a,0x00,0x00,0x01,0x00,0x00,0x02]
; CHECK:  nop   stack-=[42 + r1]                ; encoding: [0x00,0x00,0x00,0x2a,0x00,0x01,0x00,0x05]

; CHECK:  nop   stack+=[42 + r1]                ; encoding: [0x00,0x2a,0x00,0x00,0x01,0x00,0x00,0x02]
; CHECK:  nop   stack-=[42 + r1]                ; encoding: [0x00,0x00,0x00,0x2a,0x00,0x01,0x00,0x05]

; CHECK:  nop                                   ; encoding: [0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01]
; CHECK:  nop                                   ; encoding: [0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01]
