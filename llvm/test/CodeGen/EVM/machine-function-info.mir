# RUN: llc -x mir -run-pass=evm-backward-propagation-stackification < %s | FileCheck %s

# Test that we can properly read the machine function info from MIR and
# that isStackified is changed to true after stackification.

--- |
  ; ModuleID = 'test.ll'
  source_filename = "test.ll"
  target datalayout = "E-p:256:256-i256:256:256-S256-a:256:256"
  target triple = "evm"

  define i256 @test(i256 %arg1, i256 %arg2) {
    ret i256 %arg1
  }

...
# CHECK-LABEL: name: test
# CHECK: machineFunctionInfo:
# CHECK:   isStackified:    true
# CHECK:   numberOfParameters: 2
# CHECK:   hasPushDeployAddress: false
---
name:            test
alignment:       1
tracksRegLiveness: true
machineFunctionInfo:
  isStackified:    false
  numberOfParameters: 2
  hasPushDeployAddress: false
body:             |
  bb.0 (%ir-block.0):
    liveins: $arguments, $value_stack

    %0:gpr = ARGUMENT 0, implicit $arguments, implicit-def $value_stack, implicit $value_stack
    RET %0, implicit-def dead $arguments, implicit-def $value_stack, implicit $value_stack

...
