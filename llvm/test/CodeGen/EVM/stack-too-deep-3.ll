; NOTE: Assertions have been autogenerated by utils/update_llc_test_checks.py UTC_ARGS: --version 5
; RUN: llc -evm-stack-region-offset=128 -evm-stack-region-size=32 < %s | FileCheck %s

target datalayout = "E-p:256:256-i256:256:256-S256-a:256:256"
target triple = "evm-unknown-unknown"

declare void @llvm.memmove.p1.p1.i256(ptr addrspace(1) nocapture writeonly, ptr addrspace(1) nocapture readonly, i256, i1 immarg) #0

define dso_local fastcc void @main() unnamed_addr {
; CHECK-LABEL: main:
; CHECK:       ; %bb.0: ; %entry
; CHECK-NEXT:    JUMPDEST
; CHECK-NEXT:    POP
; CHECK-NEXT:    PUSH0
; CHECK-NEXT:    PUSH4 @.BB0_12
; CHECK-NEXT:    JUMPI
; CHECK-NEXT:  .BB0_1: ; %"block_rt_2/0"
; CHECK-NEXT:    JUMPDEST
; CHECK-NEXT:  .BB0_2: ; %"block_rt_158/3"
; CHECK-NEXT:    ; in Loop: Header=BB0_10 Depth=2
; CHECK-NEXT:    JUMPDEST
; CHECK-NEXT:    DUP13
; CHECK-NEXT:    SWAP12
; CHECK-NEXT:    DUP13
; CHECK-NEXT:    CALLDATALOAD
; CHECK-NEXT:    SWAP1
; CHECK-NEXT:    DUP2
; CHECK-NEXT:    PUSH1 0x5
; CHECK-NEXT:    SHL
; CHECK-NEXT:    SWAP15
; CHECK-NEXT:    DUP16
; CHECK-NEXT:    PUSH0
; CHECK-NEXT:    SUB
; CHECK-NEXT:    SWAP1
; CHECK-NEXT:    PUSH1 0x20
; CHECK-NEXT:    ADD
; CHECK-NEXT:    SGT
; CHECK-NEXT:    ISZERO
; CHECK-NEXT:    PUSH4 @.BB0_4
; CHECK-NEXT:    JUMPI
; CHECK-NEXT:  ; %bb.3:
; CHECK-NEXT:    POP
; CHECK-NEXT:    POP
; CHECK-NEXT:    PUSH4 @.BB0_11
; CHECK-NEXT:    JUMP
; CHECK-NEXT:  .BB0_4: ; %"block_rt_160/3"
; CHECK-NEXT:    ; in Loop: Header=BB0_10 Depth=2
; CHECK-NEXT:    JUMPDEST
; CHECK-NEXT:    PUSH1 0x1
; CHECK-NEXT:    SWAP3
; CHECK-NEXT:    PUSH1 0x20
; CHECK-NEXT:    SWAP3
; CHECK-NEXT:    PUSH1 0x60
; CHECK-NEXT:    DUP5
; CHECK-NEXT:    SWAP4
; CHECK-NEXT:    ADD
; CHECK-NEXT:    MSTORE
; CHECK-NEXT:    ADD
; CHECK-NEXT:    SWAP7
; CHECK-NEXT:    ADD
; CHECK-NEXT:    SWAP4
; CHECK-NEXT:    AND
; CHECK-NEXT:    SWAP12
; CHECK-NEXT:    ADD
; CHECK-NEXT:    SWAP4
; CHECK-NEXT:    PUSH0
; CHECK-NEXT:    SWAP1
; CHECK-NEXT:    PUSH1 0x40
; CHECK-NEXT:    DUP7
; CHECK-NEXT:    ADD
; CHECK-NEXT:    SWAP13
; CHECK-NEXT:    ISZERO
; CHECK-NEXT:    PUSH4 @.BB0_6
; CHECK-NEXT:    JUMPI
; CHECK-NEXT:  ; %bb.5: ; in Loop: Header=BB0_10 Depth=2
; CHECK-NEXT:    SWAP12
; CHECK-NEXT:    SWAP1
; CHECK-NEXT:    SWAP3
; CHECK-NEXT:    SWAP5
; CHECK-NEXT:    SWAP11
; CHECK-NEXT:    SWAP12
; CHECK-NEXT:    PUSH4 @.BB0_10
; CHECK-NEXT:    JUMP
; CHECK-NEXT:  .BB0_6: ; %"block_rt_181/0"
; CHECK-NEXT:    ; in Loop: Header=BB0_13 Depth=1
; CHECK-NEXT:    JUMPDEST
; CHECK-NEXT:    POP
; CHECK-NEXT:    POP
; CHECK-NEXT:    POP
; CHECK-NEXT:    POP
; CHECK-NEXT:    POP
; CHECK-NEXT:    POP
; CHECK-NEXT:    PUSH1 0x20
; CHECK-NEXT:    DUP1
; CHECK-NEXT:    PUSH1 0x1
; CHECK-NEXT:    SWAP3
; CHECK-NEXT:    ADD
; CHECK-NEXT:    SWAP3
; CHECK-NEXT:    ADD
; CHECK-NEXT:    SWAP4
; CHECK-NEXT:    ADD
; CHECK-NEXT:    SWAP2
; CHECK-NEXT:    DUP7
; CHECK-NEXT:    SWAP1
; CHECK-NEXT:    DUP6
; CHECK-NEXT:    DUP5
; CHECK-NEXT:    LT
; CHECK-NEXT:    ISZERO
; CHECK-NEXT:    PUSH4 @.BB0_8
; CHECK-NEXT:    JUMPI
; CHECK-NEXT:  ; %bb.7: ; in Loop: Header=BB0_13 Depth=1
; CHECK-NEXT:    DUP1
; CHECK-NEXT:    SWAP4
; CHECK-NEXT:    SWAP5
; CHECK-NEXT:    SWAP3
; CHECK-NEXT:    SWAP2
; CHECK-NEXT:    SWAP7
; CHECK-NEXT:    SWAP8
; CHECK-NEXT:    POP
; CHECK-NEXT:    PUSH4 @.BB0_13
; CHECK-NEXT:    JUMP
; CHECK-NEXT:  .BB0_8: ; %"block_rt_187/0.loopexit"
; CHECK-NEXT:    JUMPDEST
; CHECK-NEXT:    POP
; CHECK-NEXT:    POP
; CHECK-NEXT:    POP
; CHECK-NEXT:    POP
; CHECK-NEXT:    POP
; CHECK-NEXT:    POP
; CHECK-NEXT:    POP
; CHECK-NEXT:    PUSH0
; CHECK-NEXT:    PUSH1 0x40
; CHECK-NEXT:    DUP2
; CHECK-NEXT:    SWAP3
; CHECK-NEXT:    ADD
; CHECK-NEXT:    MCOPY
; CHECK-NEXT:  .BB0_9: ; %"block_rt_188/0"
; CHECK-NEXT:    ; in Loop: Header=BB0_13 Depth=1
; CHECK-NEXT:    JUMPDEST
; CHECK-NEXT:    PUSH1 0x1
; CHECK-NEXT:    SWAP6
; CHECK-NEXT:    PUSH0
; CHECK-NEXT:    SWAP7
; CHECK-NEXT:    PUSH0
; CHECK-NEXT:    DUP10
; CHECK-NEXT:    PUSH1 0x80
; CHECK-NEXT:    MLOAD ; Reload Reuse
; CHECK-NEXT:    SUB
; CHECK-NEXT:    SGT
; CHECK-NEXT:    SWAP1
; CHECK-NEXT:    DUP10
; CHECK-NEXT:    SWAP3
; CHECK-NEXT:    DUP1
; CHECK-NEXT:    SWAP10
; CHECK-NEXT:    DUP2
; CHECK-NEXT:  .BB0_10: ; %conditional_rt_181_join_block
; CHECK-NEXT:    ; Parent Loop BB0_13 Depth=1
; CHECK-NEXT:    ; => This Inner Loop Header: Depth=2
; CHECK-NEXT:    JUMPDEST
; CHECK-NEXT:    DUP5
; CHECK-NEXT:    DUP4
; CHECK-NEXT:    DUP4
; CHECK-NEXT:    SUB
; CHECK-NEXT:    DUP3
; CHECK-NEXT:    MSTORE
; CHECK-NEXT:    PUSH4 @.BB0_2
; CHECK-NEXT:    JUMPI
; CHECK-NEXT:  .BB0_11:
; CHECK-NEXT:    JUMPDEST
; CHECK-NEXT:    POP
; CHECK-NEXT:    POP
; CHECK-NEXT:    POP
; CHECK-NEXT:    POP
; CHECK-NEXT:    POP
; CHECK-NEXT:    POP
; CHECK-NEXT:    PUSH4 @.BB0_14
; CHECK-NEXT:    JUMP
; CHECK-NEXT:  .BB0_12: ; %"block_rt_7/0"
; CHECK-NEXT:    JUMPDEST
; CHECK-NEXT:    PUSH1 0x24
; CHECK-NEXT:    PUSH1 0x4
; CHECK-NEXT:    CALLDATALOAD
; CHECK-NEXT:    ADD
; CHECK-NEXT:    PUSH1 0xE0
; CHECK-NEXT:    PUSH1 0x1F
; CHECK-NEXT:    PUSH0
; CHECK-NEXT:    SUB
; CHECK-NEXT:    PUSH1 0x80
; CHECK-NEXT:    MSTORE ; Reload Reuse
; CHECK-NEXT:    PUSH1 0x4
; CHECK-NEXT:    DUP1
; CHECK-NEXT:    CALLDATALOAD
; CHECK-NEXT:    ADD
; CHECK-NEXT:    CALLDATALOAD
; CHECK-NEXT:    PUSH0
; CHECK-NEXT:    PUSH1 0x63
; CHECK-NEXT:    DUP2
; CHECK-NEXT:    SUB
; CHECK-NEXT:    SGT
; CHECK-NEXT:    SWAP2
; CHECK-NEXT:    DUP3
; CHECK-NEXT:    PUSH0
; CHECK-NEXT:    SWAP2
; CHECK-NEXT:    DUP6
; CHECK-NEXT:    SWAP1
; CHECK-NEXT:    PUSH0
; CHECK-NEXT:    SWAP6
; CHECK-NEXT:  .BB0_13: ; %conditional_rt_187_join_block
; CHECK-NEXT:    ; =>This Loop Header: Depth=1
; CHECK-NEXT:    ; Child Loop BB0_10 Depth 2
; CHECK-NEXT:    JUMPDEST
; CHECK-NEXT:    PUSH4 @.BB0_9
; CHECK-NEXT:    JUMPI
; CHECK-NEXT:  .BB0_14:
; CHECK-NEXT:    JUMPDEST
; CHECK-NEXT:    POP
; CHECK-NEXT:    POP
; CHECK-NEXT:    POP
; CHECK-NEXT:    POP
; CHECK-NEXT:    POP
; CHECK-NEXT:    POP
; CHECK-NEXT:    POP
; CHECK-NEXT:    PUSH4 @.BB0_1
; CHECK-NEXT:    JUMP
entry:
  br i1 poison, label %"block_rt_7/0", label %"block_rt_2/0"

"block_rt_2/0":                                   ; preds = %conditional_rt_187_join_block, %conditional_rt_181_join_block, %"block_rt_158/3", %entry
  unreachable

"block_rt_7/0":                                   ; preds = %entry
  %calldata_load_result2781 = load i256, ptr addrspace(2) inttoptr (i256 4 to ptr addrspace(2)), align 4
  %addition_result2798 = add nuw nsw i256 %calldata_load_result2781, 4
  %calldataload_pointer2604 = inttoptr i256 %addition_result2798 to ptr addrspace(2)
  %calldata_load_result2605 = load i256, ptr addrspace(2) %calldataload_pointer2604, align 1
  %addition_result2659 = add nuw nsw i256 %calldata_load_result2781, 36
  %addition_result1186 = add nsw i256 0, -99
  %subtraction_result1906 = add nsw i256 0, -31
  br label %conditional_rt_187_join_block

"block_rt_158/3":                                 ; preds = %conditional_rt_181_join_block
  %addition_result3239 = add i256 0, %addition_result3756
  %calldataload_pointer3244 = inttoptr i256 %addition_result3239 to ptr addrspace(2)
  %calldata_load_result3245 = load i256, ptr addrspace(2) %calldataload_pointer3244, align 1
  %addition_result3251 = add i256 %addition_result3239, 32
  %shift_left_non_overflow_result3390 = shl nuw nsw i256 %calldata_load_result3245, 5
  %subtraction_result3395 = sub i256 0, %shift_left_non_overflow_result3390
  %comparison_result3399.not = icmp sgt i256 %addition_result3251, %subtraction_result3395
  br i1 %comparison_result3399.not, label %"block_rt_2/0", label %"block_rt_160/3"

"block_rt_160/3":                                 ; preds = %"block_rt_158/3"
  %memory_store_pointer3530 = inttoptr i256 %stack_var_021.06950 to ptr addrspace(1)
  %addition_result3535 = add i256 %stack_var_021.0.in6947, 96
  %memory_store_pointer3538 = inttoptr i256 %addition_result3535 to ptr addrspace(1)
  store i256 %calldata_load_result3245, ptr addrspace(1) %memory_store_pointer3538, align 1
  %addition_result3694 = add i256 %shift_left_non_overflow_result3390, %stack_var_021.06950
  %addition_result3972 = add i256 %stack_var_022.06948, 32
  %addition_result3978 = add i256 %stack_var_017.26946, 32
  %stack_var_021.0 = add i256 %addition_result3694, 64
  br i1 %comparison_result3909.not, label %conditional_rt_181_join_block, label %"block_rt_181/0"

"block_rt_181/0":                                 ; preds = %"block_rt_160/3"
  %addition_result4058 = add i256 %stack_var_012.36954, 32
  %addition_result4064 = add i256 %stack_var_011.36953, 32
  %addition_result4044 = add nuw i256 %stack_var_013.36955, 1
  %comparison_result4003.not = icmp ult i256 %addition_result4044, %calldata_load_result2605
  br i1 %comparison_result4003.not, label %conditional_rt_187_join_block, label %"block_rt_187/0.loopexit"

"block_rt_187/0.loopexit":                        ; preds = %"block_rt_181/0"
  %addition_result451 = add i256 %stack_var_021.0, 64
  %mcopy_destination455 = inttoptr i256 %addition_result451 to ptr addrspace(1)
  tail call void @llvm.memmove.p1.p1.i256(ptr addrspace(1) align 1 %mcopy_destination455, ptr addrspace(1) align 1 poison, i256 poison, i1 false)
  unreachable

"block_rt_188/0":                                 ; preds = %conditional_rt_187_join_block
  %addition_result4054 = add i256 0, %addition_result2659
  br label %conditional_rt_181_join_block

conditional_rt_181_join_block:                    ; preds = %"block_rt_188/0", %"block_rt_160/3"
  %stack_var_021.06950 = phi i256 [ poison, %"block_rt_188/0" ], [ %stack_var_021.0, %"block_rt_160/3" ]
  %comparison_result3909.not = phi i1 [ true, %"block_rt_188/0" ], [ false, %"block_rt_160/3" ]
  %stack_var_022.06948 = phi i256 [ %addition_result4054, %"block_rt_188/0" ], [ %addition_result3972, %"block_rt_160/3" ]
  %stack_var_021.0.in6947 = phi i256 [ %stack_var_010.26952, %"block_rt_188/0" ], [ %addition_result3694, %"block_rt_160/3" ]
  %stack_var_017.26946 = phi i256 [ %stack_var_010.26952, %"block_rt_188/0" ], [ %addition_result3978, %"block_rt_160/3" ]
  %subtraction_result3918 = sub i256 %stack_var_021.06950, %stack_var_010.26952
  %memory_store_pointer3922 = inttoptr i256 %stack_var_017.26946 to ptr addrspace(1)
  store i256 %subtraction_result3918, ptr addrspace(1) %memory_store_pointer3922, align 1
  %calldataload_pointer1898 = inttoptr i256 %stack_var_022.06948 to ptr addrspace(2)
  %addition_result3756 = add i256 0, %addition_result4054
  %addition_result1811 = sub i256 %subtraction_result1906, %addition_result3756
  %comparison_result1815.not = icmp slt i256 0, %addition_result1811
  br i1 %comparison_result1815.not, label %"block_rt_158/3", label %"block_rt_2/0"

conditional_rt_187_join_block:                    ; preds = %"block_rt_181/0", %"block_rt_7/0"
  %stack_var_013.36955 = phi i256 [ 0, %"block_rt_7/0" ], [ %addition_result4044, %"block_rt_181/0" ]
  %stack_var_012.36954 = phi i256 [ %addition_result2659, %"block_rt_7/0" ], [ %addition_result4058, %"block_rt_181/0" ]
  %stack_var_011.36953 = phi i256 [ 224, %"block_rt_7/0" ], [ %addition_result4064, %"block_rt_181/0" ]
  %stack_var_010.26952 = phi i256 [ poison, %"block_rt_7/0" ], [ %stack_var_021.0, %"block_rt_181/0" ]
  %memory_store_pointer4021 = inttoptr i256 %stack_var_011.36953 to ptr addrspace(1)
  %calldataload_pointer4024 = inttoptr i256 %stack_var_012.36954 to ptr addrspace(2)
  %comparison_result4030.not = icmp slt i256 0, %addition_result1186
  br i1 %comparison_result4030.not, label %"block_rt_188/0", label %"block_rt_2/0"
}

attributes #0 = { nocallback nofree nounwind willreturn memory(argmem: readwrite) }
